import time
from telegram import Update
from telegram.ext import ApplicationBuilder, CommandHandler, MessageHandler, filters, ContextTypes

# Define Q&A pairs
qa_pairs = [
    ("Как настроить AutoTS?",
     "Система AutoTS — это интегрированная в диски система пограничного распределения, которая позволяет комфортно активировать различные процессы пограничного распределения удобрений через терминал из кабины трактора. Это может быть внесение удобрений по краям, границам и вдоль канав для любой из сторон. Принцип работы AutoTS заключается в том, что сервомотор поворачивает распределяющую лопатку на 10°, что позволяет удобрениям подаваться на более короткие распределительные лопатки. Это обеспечивает более точное поперечное распределение до границ поля и позволяет избежать механического воздействия.\n\n"
     "Настройка системы AutoTS для стандартного распределения включает в себя использование калькулятора пограничного распределения, который позволяет рассчитать дополнительную выручку. Система способна обеспечить среднюю прибавку урожайности в размере 17% по сравнению с традиционной системой.\n\n"
     "Для настройки направляющей лопатки для пограничного распределения в системе AutoTS не требуется компромиссов между стандартным распределением и распределением по краям, границам и вдоль канав. Это подтверждается техническим заданием для разработки распределителя Amazone ZA-TS.\n\n"
     "Система AutoTS также позволяет автоматически снижать норму внесения при пограничном распределении, изменяя норму внесения со свободно выбираемыми %-ными интервалами и управляя распределительными дисками независимо друг от друга.\n\n"
     "Для более детальной настройки и обслуживания системы AutoTS, в информации упоминаются такие моменты, как настройка источника сигнала скорости, выравнивание разбрасывателя, обслуживание разбрасывателя, подключение устройства Bluetooth, настройка ArgusTwin и WindControl."),
    ("Что делать перед запуском ZG-TS?",
     "Действия перед первым вводом в эксплуатацию ZG-TS:\n\n"
     "1. Закройте обе заслонки.\n"
     "2. Выключите распределяющие диски.\n"
     "3. Включите блок управления трактора красный, тем самым перекрыв подачу гидравлического масла к блоку.\n"
     "4. Проверьте посадку консоли WindControl на отсутствие зазора в рабочем положении. При необходимости подтяните болт и контргайку.\n"
     "5. Убедитесь, что агрегат оснащён ходовыми колесами, заменив аварийные на ходовые.\n"
     "6. Используйте при монтаже колес конусные кольца перед колесными гайками и ободья с подходящей зенковкой для крепления конусных колец.\n"
     "7. Перед вводом в эксплуатацию проведите испытание тормозной системы при пустом и загруженном агрегате.\n"
     "8. Отрегулируйте высоту тягово-сцепного устройства.\n"
     "9. Настройте гидросистему с помощью регулировочного винта, убедившись, что гидросистемы трактора и машины приведены во взаимное соответствие.\n"
     "10. Установите и обеспечьте функционирование всех предохранительных и защитных приспособлений.\n"
     "11. Перед началом работ с электрической системой отсоедините аккумулятор (отрицательный полюс).\n"
     "12. Используйте только предписанные предохранители.\n"
     "13. Следите за правильностью подключения аккумулятора и не допускайте открытого пламени вблизи аккумулятора.\n"
     "14. Учитывайте допустимые варианты комбинации тягово-сцепных устройств трактора и агрегата.\n"
     "15. Обеспечьте, чтобы оператором агрегата был человек, обученный и прошедший инструктаж по безопасной эксплуатации."),
    ("Как подключить терминал аматрон 4 к isobus?",
     "Для подключения терминала управления AmaTron 4 к ISOBUS следуйте инструкциям:\n\n"
     "1. В меню настроек выберите 'ISOBUS'.\n"
     "2. Если управление агрегатом должно использоваться на AmaTron 4, активируйте UT.\n"
     "3. Если подключенное устройство ввода AUX-N должно настраиваться через AmaTron 4, выберите в поле 'Номер UT' значение 1.\n"
     "4. Если необходимо, чтобы управление агрегатом отображалось на AmaTron 4, измените номер UT в системе управления агрегатом на номер UT терминала AmaTron 4.\n"
     "5. Если документирование заданий должно использоваться на AmaTron 4, активируйте TC.\n"
     "6. Если документирование заданий и автоматическое управление секциями подключенного агрегата должны использоваться на терминале AmaTron 4, измените номер TC в системе управления агрегатом на номер TC терминала AmaTron 4.\n\n"
     "Примечание: Если помимо AmaTron 4 подключены другие терминалы управления, автоматически будет выбран свободный номер UT и номер TC. Для корректной работы необходимо настроить номера UT и TC в системе управления агрегатом.")
]

# Handle /start command
async def start(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    await update.message.reply_text("Добро пожаловать! Задавайте вопросы о технике Amazone, и я постараюсь вам помочь.")

# Handle incoming messages
async def handle_message(update: Update, context: ContextTypes.DEFAULT_TYPE) -> None:
    user_message = update.message.text.strip()
    response = None

    # Simulate reply delay
    await update.message.reply_text("Думаю...")
    time.sleep(1)

    for question, answer in qa_pairs:
        if user_message.lower() == question.lower():
            response = answer
            break

    if response:
        await update.message.reply_text(response)
    else:
        await update.message.reply_text("Извините, я не понимаю ваш запрос. Попробуйте задать вопрос, связанный с техникой Amazone")

def main():
    # Replace 'YOUR_BOT_TOKEN' with your Telegram bot token
    application = ApplicationBuilder().token("7582689290:AAHF-ZHeUPCu-fbYKJZ26tlA_2kmEP45Dqo").build()

    # Register handlers
    application.add_handler(CommandHandler("start", start))
    application.add_handler(MessageHandler(filters.TEXT & ~filters.COMMAND, handle_message))

    # Start the bot
    application.run_polling()

if __name__ == '__main__':
    main()